"use strict";(self.webpackChunktutorial_of_ai_kit=self.webpackChunktutorial_of_ai_kit||[]).push([[19],{6283:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>r,default:()=>c,frontMatter:()=>i,metadata:()=>o,toc:()=>d});var a=n(5893),s=n(1151);const i={sidebar_position:2},r="Meta Llama 3.2 1B/3B",o={id:"Chapter_4-Large_Language_Model/Run_Llama_on_RaspberryPi",title:"Meta Llama 3.2 1B/3B",description:"Introduction",source:"@site/../articles/Chapter_4-Large_Language_Model/Run_Llama_on_RaspberryPi.md",sourceDirName:"Chapter_4-Large_Language_Model",slug:"/Chapter_4-Large_Language_Model/Run_Llama_on_RaspberryPi",permalink:"/Tutorial-of-AI-Kit-with-Raspberry-Pi-From-Zero-to-Hero/docs/Chapter_4-Large_Language_Model/Run_Llama_on_RaspberryPi",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"tutorialSidebar",previous:{title:"Setup Ollama on RaspberryPi",permalink:"/Tutorial-of-AI-Kit-with-Raspberry-Pi-From-Zero-to-Hero/docs/Chapter_4-Large_Language_Model/Setup_Ollama_on_RaspberryPi"},next:{title:"Google Gemma 2 2B",permalink:"/Tutorial-of-AI-Kit-with-Raspberry-Pi-From-Zero-to-Hero/docs/Chapter_4-Large_Language_Model/Run_Gemma2_on_RaspberryPi"}},l={},d=[{value:"Introduction",id:"introduction",level:2},{value:"Install Ollama",id:"install-ollama",level:2},{value:"Install and run llama",id:"install-and-run-llama",level:2}];function h(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.a)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.h1,{id:"meta-llama-32-1b3b",children:"Meta Llama 3.2 1B/3B"}),"\n",(0,a.jsx)(t.h2,{id:"introduction",children:"Introduction"}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{src:n(8140).Z+"",width:"356",height:"331"})}),"\n",(0,a.jsxs)(t.p,{children:["Let's install and run our first small language model, ",(0,a.jsx)(t.a,{href:"https://ai.meta.com/blog/llama-3-2-connect-2024-vision-edge-mobile-devices/",children:"Llama 3.2"})," 1B (and 3B). The Meta Llama, 3.2 collections of multilingual large language models (LLMs),  is a collection of pre-trained and instruction-tuned generative models in 1B and 3B sizes (text in/text out). The Llama 3.2 instruction-tuned text-only models are optimized for multilingual dialogue use cases, including agentic retrieval and summarization tasks."]}),"\n",(0,a.jsx)(t.p,{children:"The 1B and 3B models were pruned from the Llama 8B, and then logits from the 8B and 70B models were used as token-level targets (token-level distillation). Knowledge distillation was used to recover performance (they were trained with 9 trillion tokens). The 1B model has 1,24B, quantized to integer (Q8_0), and the 3B, 3.12B parameters, with a Q4_0 quantization, which ends with a size of 1.3 GB and 2GB, respectively. Its context window is 131,072 tokens."}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{src:n(7556).Z+"",width:"1450",height:"722"})}),"\n",(0,a.jsx)(t.h2,{id:"install-ollama",children:"Install Ollama"}),"\n",(0,a.jsxs)(t.p,{children:["Please refer to this ",(0,a.jsx)(t.a,{href:"https://github.com/Seeed-Projects/Tutorial-of-AI-Kit-with-Raspberry-Pi-From-Zero-to-Hero/blob/main/articles/Chapter%204%20-%20Large%20Language%20Model/Setup_Ollama_on_RaspberryPi.md",children:"article"})]}),"\n",(0,a.jsx)(t.h2,{id:"install-and-run-llama",children:"Install and run llama"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-bash",children:"ollama run llama3.2:1b\n"})}),"\n",(0,a.jsx)(t.p,{children:"Running the model with the command before, we should have the Ollama prompt available for us to input a question and start chatting with the LLM model; for example,"}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.code,{children:">>> What is the capital of France?"})}),"\n",(0,a.jsx)(t.p,{children:"Almost immediately, we get the correct answer:"}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.code,{children:"The capital of France is Paris."})}),"\n",(0,a.jsxs)(t.p,{children:["Using the option ",(0,a.jsx)(t.code,{children:"--verbose"})," when calling the model will generate several statistics about its performance (The model will be polling only the first time we run the command)."]}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{src:n(6650).Z+"",width:"991",height:"717"})}),"\n",(0,a.jsx)(t.p,{children:"Each metric gives insights into how the model processes inputs and generates outputs. Here\u2019s a breakdown of what each metric means:"}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.strong,{children:"Total Duration (2.620170326s)"}),": This is the complete time taken from the start of the command to the completion of the response. It encompasses loading the model, processing the input prompt, and generating the response."]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.strong,{children:"Load Duration (39.947908ms)"}),": This duration indicates the time to load the model or necessary components into memory. If this value is minimal, it can suggest that the model was preloaded or that only a minimal setup was required."]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.strong,{children:"Prompt Eval Count (32 tokens)"}),": The number of tokens in the input prompt. In NLP, tokens are typically words or subwords, so this count includes all the tokens that the model evaluated to understand and respond to the query."]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.strong,{children:"Prompt Eval Duration (1.644773s)"}),": This measures the model's time to evaluate or process the input prompt. It accounts for the bulk of the total duration, implying that understanding the query and preparing a response is the most time-consuming part of the process."]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.strong,{children:"Prompt Eval Rate (19.46 tokens/s)"}),": This rate indicates how quickly the model processes tokens from the input prompt. It reflects the model\u2019s speed in terms of natural language comprehension."]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.strong,{children:"Eval Count (8 token(s))"}),": This is the number of tokens in the model\u2019s response, which in this case was, \u201cThe capital of France is Paris.\u201d"]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.strong,{children:"Eval Duration (889.941ms)"}),": This is the time taken to generate the output based on the evaluated input. It\u2019s much shorter than the prompt evaluation, suggesting that generating the response is less complex or computationally intensive than understanding the prompt."]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.strong,{children:"Eval Rate (8.99 tokens/s)"}),": Similar to the prompt eval rate, this indicates the speed at which the model generates output tokens. It's a crucial metric for understanding the model's efficiency in output generation."]}),"\n"]}),"\n",(0,a.jsx)(t.p,{children:"This detailed breakdown can help understand the computational demands and performance characteristics of running SLMs like Llama on edge devices like the Raspberry Pi 5. It shows that while prompt evaluation is more time-consuming, the actual generation of responses is relatively quicker. This analysis is crucial for optimizing performance and diagnosing potential bottlenecks in real-time applications."}),"\n",(0,a.jsx)(t.p,{children:"Loading and running the 3B model, we can see the difference in performance for the same prompt;"}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{src:n(9032).Z+"",width:"936",height:"409"})}),"\n",(0,a.jsx)(t.p,{children:"The eval rate is lower, 5.3 tokens/s versus 9 tokens/s with the smaller model."}),"\n",(0,a.jsx)(t.p,{children:"When question about"}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.code,{children:">>> What is the distance between Paris and Santiago, Chile?"})}),"\n",(0,a.jsxs)(t.p,{children:["The 1B model answered ",(0,a.jsx)(t.code,{children:"9,841 kilometers (6,093 miles)"}),", which is inaccurate, and the 3B model answered ",(0,a.jsx)(t.code,{children:"7,300 miles (11,700 km)"}),", which is close to the correct (11,642 km)."]}),"\n",(0,a.jsx)(t.p,{children:"Let's ask for the Paris's coordinates:"}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.code,{children:">>> what is the latitude and longitude of Paris?"})}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-bash",children:"The latitude and longitude of Paris are 48.8567\xb0 N (48\xb055' \n42\" N) and 2.3510\xb0 E (2\xb022' 8\" E), respectively.\n"})}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{src:n(6233).Z+"",width:"1408",height:"584"})}),"\n",(0,a.jsx)(t.p,{children:"Both 1B and 3B models gave correct answers."})]})}function c(e={}){const{wrapper:t}={...(0,s.a)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(h,{...e})}):h(e)}},7556:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/llama3_2-abbd92bd24fab394afa347345887f517.jpg"},6650:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/llama3_2_1b_performance-1c6d3236514211dead330a657f389713.png"},9032:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/llama3_2_3b_performance-37b7087b03839ce83eaac0ba88294587.png"},6233:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/paris-lat-lon-5cfda6867ee9c7fa282019e1406df7d0.png"},8140:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/small_and_multimodal-727354fed25de380d3eb07dcf264a643.png"},1151:(e,t,n)=>{n.d(t,{Z:()=>o,a:()=>r});var a=n(7294);const s={},i=a.createContext(s);function r(e){const t=a.useContext(i);return a.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),a.createElement(i.Provider,{value:t},e.children)}}}]);